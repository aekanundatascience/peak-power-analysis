# การวิเคราะห์ช่วงเวลาที่มีการใช้พลังงานสูงสุด

โค้ดนี้ใช้สำหรับวิเคราะห์ช่วงเวลาที่มีการใช้พลังงานสูงสุดในแต่ละวันจากข้อมูลในตาราง dispatcher ของฐานข้อมูล MS SQL

## ไฟล์ในโปรเจคนี้

- `peak_power_analysis.py`: สคริปต์หลักสำหรับวิเคราะห์ข้อมูลและสร้างกราฟ
- `README.md`: ไฟล์นี้ อธิบายวิธีการใช้งานโปรเจค
- `requirements.txt`: รายการไลบรารีที่จำเป็น
- `environment.yml`: ไฟล์สำหรับการสร้าง conda environment

## ความต้องการเบื้องต้น

- Python 3.6+
- ไลบรารี Python ที่จำเป็น:
  - pandas
  - matplotlib
  - seaborn
  - pyodbc
  - numpy

## การติดตั้ง

### วิธีที่ 1: ติดตั้งด้วย pip
```bash
pip install pandas matplotlib seaborn pyodbc numpy
```

### วิธีที่ 2: ติดตั้งด้วย conda (แนะนำ)

#### ติดตั้งแต่ละไลบรารี
```bash
conda install pandas matplotlib seaborn numpy
conda install -c conda-forge pyodbc
```

#### หรือติดตั้งจากไฟล์ environment.yml (ง่ายกว่า)
```bash
conda env create -f environment.yml
conda activate peak_power_analysis
```

## การใช้งาน

ข้อมูลการเชื่อมต่อฐานข้อมูลได้ถูกตั้งค่าไว้แล้วในฟังก์ชัน `connect_to_database()` ในไฟล์ `peak_power_analysis.py` ดังนี้:

```python
DB_SERVER = '34.134.173.24'
DB_NAME = 'Electric'
DB_USER = 'SA'
DB_PASSWORD = 'Passw0rd123456'
```

เพียงรันสคริปต์:

```bash
python peak_power_analysis.py
```

## ผลลัพธ์

เมื่อรันสคริปต์จะได้ผลลัพธ์ดังนี้:

1. ไฟล์ CSV:
   - `peak_hours_by_day.csv`: ข้อมูลช่วงเวลาที่มีการใช้พลังงานสูงสุดในแต่ละวัน
   - `peak_hour_frequency.csv`: ข้อมูลความถี่ของช่วงเวลาที่มีการใช้พลังงานสูงสุด

2. กราฟ:
   - `peak_hours_by_day.png`: กราฟแสดงช่วงเวลาที่มีการใช้พลังงานสูงสุดในแต่ละวัน
   - `peak_hour_frequency.png`: กราฟแสดงความถี่ของช่วงเวลาที่มีการใช้พลังงานสูงสุด
   - `power_heatmap.png`: Heatmap แสดงการใช้พลังงานตามช่วงเวลาและวันที่

## สรุปผลการวิเคราะห์

1. ช่วงเวลาที่มีการใช้พลังงานสูงสุดส่วนใหญ่อยู่ในช่วงเย็น (17:00-20:00 น.)
2. ช่วงเวลา 19:00 น. และ 20:00 น. เป็นช่วงเวลาที่พบการใช้พลังงานสูงสุดบ่อยที่สุด
3. มีบางวันที่มีรูปแบบแตกต่างออกไป เช่น วันที่ 8 พ.ค. มีการใช้พลังงานสูงสุดในช่วง 9:00 น.
4. วันที่ 31 พ.ค. มีการใช้พลังงานต่ำผิดปกติ (อาจเป็นเพราะข้อมูลไม่สมบูรณ์หรือเป็นช่วงเริ่มต้นของวัน)
5. ค่าเฉลี่ยการใช้พลังงานสูงสุดในช่วง 9:00 น. มีค่ามากที่สุด (45,983) แม้จะพบเพียงครั้งเดียว

## การนำไปใช้งาน

ข้อมูลจากการวิเคราะห์นี้สามารถนำไปใช้ประโยชน์ได้ดังนี้:
- การวางแผนการจัดการพลังงาน
- การกำหนดอัตราค่าไฟฟ้าตามช่วงเวลา (Time of Use Tariff)
- การบริหารจัดการโหลดเพื่อลดการใช้พลังงานในช่วงพีค (Peak Demand Management)
- การวางแผนการบำรุงรักษาระบบไฟฟ้า